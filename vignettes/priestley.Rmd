---
title: "Joseph Priestley's \"A Chart of Biography\""
author: "Jeffrey B. Arnold"
date: "2/5/2018"
output: html_document
bibliography: ../inst/REFERENCES.bib
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{Joseph Priestley's "A Chart of Biography"}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("priestley")
```

## Introduction

Joseph Priestley's *A Chart of Biography* [@Priestley1864], first published in 1764, is the, or one of the, first instances of a modern timeline [@FriendleySigalHarnanasingh2013,@Friendly2006,@Friendly,@RosenbergGrafton2013,@wiki:chart-biography,@Davis2012].
The **priestley** is a data package containing datasets used in the the biographic information used in the 1st (1764) and 7th (1778) editions of the the *Chart of Biography*.

The timeline visualizes the lifespans of approximately two thousand individuals, 
described as "the most distinguished in the annals of fame". 
This timeline was popular in its era, being published 
The stated criteria for selection into this list was "fame" rather than "merit".

> My rule, I considered, was renown and not merit; acquired fame,
> and not deserved reputation: so that a person who had
> made a great noise in the world, though he were
> known by nothing but the devastation he had made
> in it, was more acceptable to me than one who had
> deserved ever so well of it, if he had passed through
> it without being much known.



1. Statesmen and Warriors
2. Divines and Physicians
3. Historians, Antiquarians, and Lawyers
4. Poets and Artists
5. Orators and Critics

The timeline was popular in 
The timelines include approximately two thousand individuals
(`r sum(Biographies$in_1778)` in the 1764 edition and `r sum(Biographies$in_1778)` in the 1778 edition) 

The list of individuals was both Priestley's opinion and particular to an educated 
18th century Englishman. However, the purpose of reproducing the data is not the 
subject of the data itself or its quality, 
but because it was used in a historically important data visualization.

The timeline shows the names and lines indicating lifespan.
The individuals were grouped into five categories, which are called "divisions"
in the work.

The data in this package come from the index of names  *Chart* was accompanied by a *A Description of a Chart of Biography: With a Catalogue of all the Names Inserted in It, and the Dates annexed to Them.*.
This included an index of the names, birth date, death date, age, and primary occupation of the individuals included in the *Chart*.

## Replication of a Specimen of a Chart of History

*The Chart of Biography* was distributed with a pamphlet titled 
*A Description of a Chart of Biography*, which documented the methodology of the chart and included an index of the individuals included in the chart.
Since the full chart was 2 feet x 3 feet, the *Description* also included a chart titled *A Specimen of a Chart of Biography*, which was a subset of the full chart small enough to fit on a single page.
The "Specimen" contained only `r nrow(Specimen)` individuals with lifespans between 800 BCE and 0, divided into two categories: "Men of Learning", and "Statesmen". 

![](PriestleyChart.gif)

Table: "A redacted version of Priestley's Chart of Biography (1765)." 
Wikimedia Commons contributors, "File:PriestleyChart.gif," Wikimedia Commons, the free media repository, <https://commons.wikimedia.org/w/index.php?title=File:PriestleyChart.gif&oldid=177413180>.

The data frame `priestley::Specimen` contains the data necessary to reproduce this chart.

```{r specimen-chart,message = FALSE}
library("ggplot2")

p <- ggplot(priestley::Specimen) +
  geom_segment(aes(y = row, yend = row, x = start_2, xend = end_2),
               alpha = 0.5, size = 0.5) +
  geom_segment(aes(y = row, yend = row, x = start_1, xend = end_1),
               size = 1) +
  geom_text(aes(x = (start_2 + end_2) * 0.5, y = row, label = label),
            size = 3, vjust = "bottom", nudge_y = 0.25, color = "gray50") +
  facet_wrap(~ division, ncol = 1) +
  scale_x_continuous("", 
                     minor_breaks = seq(-600, 0, 50),
                     breaks = seq(-600, 0, 100)) +
  scale_y_continuous("", expand = c(0.1, 0.1)) +
  ggtitle("A Specimen of the Chart of Biography") +
  theme_minimal() +
  theme(panel.grid.minor.y = element_blank(),
        panel.grid.major.y = element_blank(),
        strip.background = element_rect(fill = "white", colour = NA),
        axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        strip.text = element_text(face = "bold"))
```

```{r}
ggplotly(p) %>% 
  plotly_json()
```


## Replication of the Full Chart

The full chart contains over 2,000 individuals and when printed was "about three feet in length,
and two feet in breadth".  The data frame `priestley::Biographies` contains data on the
individuals in the chart extracted from the name index.

```{r message=FALSE, fig.width = 14, fig.height = 7}
start_year <- -1300
end_year <- 1800

bios <- priestley::Biographies %>%
  filter(in_1778) %>%
  ungroup() %>%
  mutate(row = layout_segments(start_2, end_2, gap = 100, random = FALSE)) %>%
  ungroup()

plot_ly() %>%
  add_segments(x = ~ start_2, xend = ~end_2, y = ~ row, yend = ~row, data = bios,
               color = ~division,
               size = I(1),
               hovertext = ~text,
               hoverinfo = "text", 
               legendgroup = ~division, 
               showlegend = FALSE) %>%
  add_segments(x = ~start_1, xend = ~end_1, y = ~row, yend = ~row, data = bios,
               color = ~division,
               size = I(2),
               hovertext = ~text, 
               hoverinfo = "text",
               legendgroup = ~division, 
               showlegend = TRUE
               ) %>%
  layout(title = "A Chart of Biography",
         hovermode = "closest",
         legend = list(orientation = "h"),
         xaxis = list(
            title = "",
            autotick = FALSE,
            tick0 = (start_year %/% 100) * 100,
            dtick = 100,
            zeroline = FALSE,
            mirror = "allticks",
            side = "bottom",
            rangeslider = list()
         ),
         yaxis = list(
                title = "",
                zeroline = FALSE,
                showline = FALSE,
                showticklabels = FALSE,
                showgrid = FALSE
         )
        )
```

```{r message=FALSE, fig.width = 14, fig.height = 7}
library("plotly")
library("dplyr")

start_year <- -1300
end_year <- 1800

one_timeline <- function(`data_`, name) {
  plot_ly() %>%
  add_segments(x = ~start_2, xend = ~end_2, y = ~row, yend = ~row,
               data = `data_`,
               size = I(1),
               hovertext = ~text,
               hoverinfo = "text", 
               color = I("black"),
               alpha = 0.5,
               showlegend = FALSE
               ) %>%
  add_segments(x = ~start_1, xend = ~end_1, y = ~row, yend = ~row,
               data = `data_`,
               sizes = 2,
               color = I("black"),
               hovertext = ~text, 
               hoverinfo = "text",
               showlegend = FALSE
               ) %>%
  layout(yaxis = list(
            title = "",
            zeroline = FALSE,
            showline = FALSE,
            showticklabels = FALSE,
            showgrid = FALSE
         ),
         xaxis = list(title = name))
}

divisions <- priestley::Biographies %>%
  filter(in_1778) %>%
  split(.$division) %>%
  map(~ mutate(., 
               row = layout_segments(start_2, end_2, 
                                     gap = 100, random = FALSE)))

max_rows <- map_int(divisions, ~ max(.x$row))

rulers <- plot_ly(data = priestley::Kings,
        x = ~year, 
        y = I(0),
        type = 'scatter', 
        mode = 'marker', 
        visible = FALSE) %>%
  layout(yaxis = list(
                title = "",
                zeroline = FALSE,
                showline = FALSE,
                showticklabels = FALSE,
                showgrid = FALSE
         ),
        annotations = list(
          text = Kings$name,
          x = Kings$year,
          y = I(0),
          xanchor = "right",
          yanchor = "bottom",
          textangle = 90,
          showarrow = FALSE,
          xref = "x7",
          yref = "y7"
        ))

imap(divisions, one_timeline) %>%
  subplot(nrows = length(divisions),
          shareX = TRUE, shareY = FALSE,
          titleX = TRUE, titleY = TRUE) %>%
  layout(title = "A Chart of Biography",
         hovermode = "closest",
         legend = list(orientation = "h"),
         xaxis = list(
            title = "",
            autotick = FALSE,
            tick0 = (start_year %/% 100) * 100,
            dtick = 100,
            zeroline = FALSE,
            # mirror = "allticks",
            side = "bottom",
            # rangeslider = list()
         ) 
        )  
```

The full dataset is listed here:
```{r}
DT::datatable(priestley::Biographies)
```


## Details

The names and dates in `priestley::Biographies` come from the name index included
in the *Description of a Chart of Biography* that was distributed with the chart itself.
The name index uses a regular, concise representation of the birth and death dates of individuals, but they can appear in several formats: indicating on or more of the year(s) in which an individual was born, died, lived, or "flourished", as well as several ways of indicating uncertainty ("before", "after", "about", and only indicating the Century).

However, the name index from which this data is derived provides the birth and death dates of individuals in a variety of text descriptions, such as

```{r echo=FALSE}
priestley::Biographies %>%
  slice(5) %>%
  select(text) %>%
  knitr::kable()
```

The *Description of a Chart of Biography* contains extensive discussion of how the lifespan segments were constructed from the available information. This section discusses how the segments in this data was generated.

Examples in which the date of death and the age at death are known. These are drawn with a single solid black line since there is no uncertainty.

-   Pindar d. 435 BC. 86 P
-   Sophocles d. 406 BC 91 P
-   Xenophon d. 359 BC. ab. 90 H
-   Plato d. 348 BC. 81 HP
-   Terence d. 159 BC. 35 P

> It is an imperfection which must necessarily attend every Chart of this
> nature, that the time of the death, but more especially the time of the birth
> of eminent men cannot always be found. In this case the compiler must content
> himself with placing his line as near as he can conjecture from history where
> his true place was, leaving marks to express the uncertainty
> there is attending it. The method I have used in
> this Chart is to express certainty by a full line, and
> what is uncertain by dots or a broken line, dispro
> of the dots in the following manner, according to the
> kind or degree of the uncertainty they have to express.
>
> If it be thought that a person was born or died but
> a little before or after a certain time, the full line
> begins or ends at the certain time, and a single dot only
> is placed at the beginning or end of the line

Examples include,

-   Herodotus b. 484 BC. d. af. 413 H

> If history informs us that he was born or died
> about a certain time, a dot is placed just under the
> beginning or end of the full line

Examples include,

-   Agis b. 24. BC. ab. 22
-   Thucydides d. ab. 391. ab. 80 H

> If the birth be certain but the death uncertain, the line begins full but ends in dots.

Examples include,

-   Abul Pharai b. 1226 l. af. 1285 H
-   Alain b. 1386 H

> If, as is often the case, the death be known but the birth
> unknown, the line begins with dots, and ends full

-   Epaminondas d. 363

> When it is faid that a writer flourished at or
> about a particular time, a short full line is drawn
> about two-thirds before and one third after that particular time,
> with three dots before and two after it; because, in
general, men are said to flourish much
> nearer the time of their death than the time of their
birth.

-   Euclid fl. 300 BC. M


> If it be uncertain even in what
> century a person lived or flourished, there is no full
> line made at all, but only dots or broken lines where
> I imagine it is most probable he might have flourished.

Priestley provides no other details about how long this line may be. However,
the examples on this [chart](http://www.enoughroomforspace.org/wp-content/uploads/cartographies-of-time_20130505_0006.jpg) have between six and seven dots, which seem
to correspond to 60--70 years.

-   Suidas fl. ab. 11 Cent. Cr                  
-   Hesychius fl. ab. 300 Cr

```{r example-ages}
examples <- c("Euclid fl. 300 BC M",
              "Epaminondas d. 363 BC",
              "Herodotus b. 484 BC d. af. 413 BC H",
              "Suidas fl. ab. 11 Cent. Cr",
              "Hesychius fl. ab. 300 Cr",
              "Agis d. 241 BC ab. 22",
              "Thucydides d. ab. 391 BC. ab. 80 H")
              
filter(Biographies, 
       text %in% examples) %>%
  select(text, start_2, start_1, end_1, end_2) %>%
  knitr::kable()
```

Table: Examples of life segments generated from the text descriptions in 
the index of names in the *Description of a Chart of Biography*.

## Miscellaneous

------- ----------------------------
d.      died
b.      born
fl.     flourished
af.     after
ab.     about
fl. ab. Considerable uncertainty
B C.    before Christ
------- ----------------------------

Table: Date abbreviations appearing in the name index.

```{r}
library("glue")

format_year <- function(x) {
  if_else(is.na(x), 
          NA_character_,
          if_else(x < 0, str_c(abs(x) + 1L, "BCE", sep = " "), as.character(x)))
}

clean_occupation <- function(x) {
  str_replace_all(str_to_lower(x), 
                 c("christian" = "Christian",
                   "muslim" = "Muslim",
                   "jewish" = "Jewish",
                   "greek" = "Greek"))
}

bios <- priestley::Biographies %>%
  mutate(a_an = if_else(str_to_lower(str_sub(occupation, 1, 1)) %in%
                          c("a", "e", "i", "o", "u"), "an", "a"),
         flourished_str = str_c(case_when(
           is.na(flourished) ~ "",
           flourished_before ~ str_c(", was active before ", format_year(flourished)),
           flourished_after ~ str_c(", was active before ", format_year(flourished)),
           flourished_about ~ str_c(", was active in about ", format_year(flourished)),
           !is.na(flourished) ~ str_c(", was active in ", format_year(flourished))
         )),
         born_str = str_c(case_when(
           is.na(born) ~ "",
           born_about ~ str_c(", was born in about ", format_year(born)),
           TRUE ~ str_c(", born in ", format_year(born))
         )),
         lived_str = str_c(case_when(
           is.na(lived) ~ "",
           TRUE ~ str_c(", lived after ", format_year(lived))
         )),
         died_str = str_c(
           case_when(
             is.na(died) ~ "",
             !is.na(age) & died_about ~ str_c(", died in about ", format_year(died), " at age ", age),
             !is.na(age) & died_after ~ str_c(", died after ", format_year(died), " at age ", age),
             !is.na(age) ~ str_c(", died in ", format_year(died), " at age ", age),
             died_about ~ str_c(", died in about ", format_year(died), " at age ", age),
             died_after ~ str_c(", died after ", format_year(died)),
             TRUE ~ str_c(", died in ", format_year(died))
           )
         ),
         age_str = str_c(case_when(
           !is.na(died) ~ "",
           !is.na(age) ~ str_c("died at age ", age),
           TRUE ~ ""
         )))

glue("{name} was {a_an} {clean_occupation(occupation)}{born_str} {flourished_str}{died_str}{age_str}.",
     .envir = bios)

```

